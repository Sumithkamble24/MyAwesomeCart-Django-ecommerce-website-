<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Ecommerce Website{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
      .navbar { background: #212529; }
      .navbar .nav-link, .navbar .navbar-brand { color: white !important; }
      .navbar .nav-link:hover { color: #ffc107 !important; }
      .navbar .navbar-brand { color: sandybrown !important; }
      .navbar-toggler { border-color: #ffc107; }
      .navbar-toggler-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='rgba(255,193,7, 1)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E");
      }
      {% block css %}{% endblock %}
    </style>
  </head>
  <body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">MyAwesomeCart</a>

        <!-- Toggler for mobile -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navbar Links -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="/shop/about">About Us</a></li>
            <li class="nav-item"><a class="nav-link" href="/shop/tracker">Tracker</a></li>
            <li class="nav-item"><a class="nav-link" href="/shop/contact">Contact Us</a></li>
            <li class="nav-item"><a class="nav-link" href="/blog">Blog</a></li>
          </ul>

          <!-- Search Form -->
          <form class="d-flex" role="search" action="/shop/search" method="get">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"
                   name="search" id="search">
            <button class="btn btn-outline-warning" type="submit">Search</button>
          </form>

          <!-- Cart -->
          <ul class="navbar-nav ms-3">
            <li class="nav-item">
              <a class="nav-link" href="#" id="cartPopover"
                 data-bs-toggle="popover" data-bs-placement="bottom"
                 data-bs-html="true" data-bs-content="Check your cart">
                Cart (<span id="cart">0</span>)
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Page Content -->
    {% block body %}{% endblock %}

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Enable Bootstrap popovers
        var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
        popoverTriggerList.map(function (popoverTriggerEl) {
          return new bootstrap.Popover(popoverTriggerEl)
        });

        // âœ… Keep cart quantity consistent across all pages
        let cart = {};
        if (localStorage.getItem('cart') !== null) {
          cart = JSON.parse(localStorage.getItem('cart'));
        }
        let totalQty = Object.values(cart).reduce((a, b) => a + (b.qty || 0), 0);
        document.getElementById('cart').innerText = totalQty;
      });
    </script>

    {% block js %}{% endblock %}
  </body>
</html>
